{% extends "base.html" %}
{% block title %}Dashboard of Student Management System{% endblock %}

{% block content %}
<h3 class="mb-4 fw-semibold">Dashboard</h3>

<div class="row g-3">
  {% if user.is_admin %}
    <!-- Students card -->
    <div class="col-md-4 col-sm-6">
      <div class="card stat-card shadow-sm p-3 border-0 h-100">
        <div class="d-flex justify-content-between align-items-center">
          <div>
            <div class="text-muted small">Students</div>
            <div class="h4 fw-bold">{{ stats.students_count }}</div>
          </div>
          <div class="icon-circle bg-light text-primary">
            <i class="bi bi-people"></i>
          </div>
        </div>
      </div>
    </div>

    <!-- Courses card -->
    <div class="col-md-4 col-sm-6">
      <div class="card stat-card shadow-sm p-3 border-0 h-100">
        <div class="d-flex justify-content-between align-items-center">
          <div>
            <div class="text-muted small">Courses</div>
            <div class="h4 fw-bold">{{ stats.courses_count }}</div>
          </div>
          <div class="icon-circle bg-light text-success">
            <i class="bi bi-journal-bookmark"></i>
          </div>
        </div>
      </div>
    </div>

    <!-- Favorites card -->
    <div class="col-md-4 col-sm-6">
      <div class="card stat-card shadow-sm p-3 border-0 h-100">
        <div class="d-flex justify-content-between align-items-center">
          <div>
            <div class="text-muted small">Favorites (total)</div>
            <div class="h4 fw-bold">{{ stats.favorites_count }}</div>
          </div>
          <div class="icon-circle bg-light text-danger">
            <i class="bi bi-heart-fill"></i>
          </div>
        </div>
      </div>
    </div>
  {% else %}
    <!-- My favorites card -->
    <div class="col-md-6 col-sm-6">
      <div class="card stat-card shadow-sm p-3 border-0 h-100">
        <div class="d-flex justify-content-between align-items-center">
          <div>
            <div class="text-muted small">My favorites</div>
            <div class="h4 fw-bold">{{ stats.my_favorites_count }}</div>
          </div>
          <div class="icon-circle bg-light text-danger">
            <i class="bi bi-heart-fill"></i>
          </div>
        </div>
      </div>
    </div>

    <!-- Total courses card -->
    <div class="col-md-6 col-sm-6">
      <div class="card stat-card shadow-sm p-3 border-0 h-100">
        <div class="d-flex justify-content-between align-items-center">
          <div>
            <div class="text-muted small">Total courses</div>
            <div class="h4 fw-bold">{{ stats.courses_count }}</div>
          </div>
          <div class="icon-circle bg-light text-success">
            <i class="bi bi-journal-bookmark"></i>
          </div>
        </div>
      </div>
    </div>
  {% endif %}
</div>

<!-- Recent courses -->
<div class="mt-5">
  <h5 class="mb-3 fw-semibold">Recent Courses</h5>
  <div class="row row-cols-1 row-cols-md-3 g-3">
    {% for c in recent_courses %}
      <div class="col">
        {% include "includes/course_card.html" with course=c favorite_ids=favorite_ids %}
      </div>
    {% empty %}
      <div class="col">
        <div class="card p-3 shadow-sm">No courses yet.</div>
      </div>
    {% endfor %}
  </div>
</div>

<!-- ===== Dashboard Animations ===== -->
<style>
  .stat-card {
    opacity: 0;
    transform: translateY(20px);
    animation: fadeUp 0.6s ease forwards;
  }

  .stat-card:nth-child(1) { animation-delay: 0.1s; }
  .stat-card:nth-child(2) { animation-delay: 0.3s; }
  .stat-card:nth-child(3) { animation-delay: 0.5s; }

  @keyframes fadeUp {
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }
</style>

{% endblock %}
